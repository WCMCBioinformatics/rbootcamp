---
title: "Creating graphics with ggplot"
output: pdf_document
---

```{r, message=FALSE, echo=FALSE}
library(knitr)
opts_chunk$set(collapse = TRUE)
```


```{r}
library("dplyr")
library("tidyr")
library("readr")
library("ggplot2")
```


## Layer upon layer: Building our first plot

Every ggplot starts with a base layer. This is an empty layer from which we build up our graphic.
```{r}
```

Now we need some data. Notice that our plot is still empty as we have yet to define how we want to plot the data.
```{r}

```

To construct a plot we must define our asthetics.  This is how we connect the data to our scales, such as the x and y scales, the colour scale, the shape scale, etc.  We do this using the `aes()` function.  

```{r}
```

Notice now we have some scales on our plot but still no data is shown becuase ggplot still doesn't know the type of plot we'd like to use.  To define what we want to plot we use `geom_XXX` functions.  In this case we want points.

```{r}
```

Here we use `+` to "add" the plot layers together.  This notation allows us to create plot objects which can be modified.

```{r}
```

We can map other variables in our data to other scales, such as colour and size
```{r}
```

Mapping factors gives us discrete scales instead of continuous

```{r}
```

Ok, now we have a figure that we like, let's put on some finishing touches

```{r}
```

## A few more plot examples

### Boxplot

```{r}
```

### Histogram
```{r}
```


### Line plot
```{r}
```

## Details

Aesthetics can be defined for each geom individually or for all geoms in the `ggplot()` call.

```{r}

```


We use facets to split our data into small multiples

```{r}

```

## Exploring our data graphically

We'll use the pa phenotype dataset here and tidy it up a bit
```{r}

```

For the growth rate in LB lets look at the change over time and see if there are differences between clinical states

```{r}

```

Here we can see that the isolates are collected in bursts over short periods of time.  Presumably these correspond to the excacerbation events.

```{r}
```

We can add a trend line to see if there is a decrease.
```{r}

```


To get a closer look at each clinical event we can use facets

```{r}

```

Save the plot
```{r}
```


An alternative view would be to look at the clincal events as boxplots

```{r}

```

We can add a colour variable to help view the plot.

```{r}
```

```{r}

```



